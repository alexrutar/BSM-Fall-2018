\documentclass[12pt, a4paper]{book}
\usepackage[ascii]{inputenc}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=4cm]{geometry}
\usepackage[protrusion=true,expansion=true]{microtype}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{tikz, pgfplots}
\usetikzlibrary{intersections}
\usepackage{kpfonts}
\usepackage{dsfont}
\pgfplotsset{compat=1.13}
\usepackage{emptypage}

\DeclareMathOperator{\N}{\mathbb{N}}
\DeclareMathOperator{\Q}{\mathbb{Q}}
\DeclareMathOperator{\Z}{\mathbb{Z}}
\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\C}{\mathbb{C}}
\DeclareMathOperator{\F}{\mathbb{F}}
\DeclareMathOperator{\re}{Re}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\supp}{supp}

\usepackage{graphicx}
\usepackage{enumitem}
\setenumerate{}

%-----------------------------------------------------------------------------------------------------------------
% Some fancy macros // May eventually move these into separate files or something and merge when building template
\renewcommand{\d}[1]{\ensuremath{\operatorname{d}\!{#1}}} % dx macro for integrals
\newcommand{\hess}[1]{\ensuremath{\operatorname{H}\!{#1}}} % Hessian
\newcommand{\diff}[1]{\ensuremath{\operatorname{D}\!{#1}}} % Jacobian
\newcommand{\inner}[2]{\left\langle #1, #2 \right\rangle} % inner product
\newcommand{\norm}[1]{\left\lVert#1\right\rVert} % norm
\newcommand{\cpl}[1]{\overline{#1}} % complement
\renewcommand{\v}[1]{\mathbf{#1}} % vector
\newenvironment{amatrix}[1]{% augumented matrix - make sure to have # columns less than required amount
  \left(\begin{array}{@{}*{#1}{c}|c@{}}
}{%
  \end{array}\right)
}
%-----------------------------------------------------------------------------------------------------------------
% Define theorem environments, along with a custom proof environment
\usepackage[thref, thmmarks,amsmath]{ntheorem}
\newcommand{\itref}[1]{\textit{\thref{#1}}}

\newtheorem{theorem}{Thm.}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Def'n.}
\newtheorem{corollary}[theorem]{Cor.}
\newtheorem{proposition}[theorem]{Prop.}

\theorembodyfont{\upshape}
\newtheorem{remark}[theorem]{Rmk.}
\newtheorem{exercise}[theorem]{Exc.}
\newtheorem{example}[theorem]{Ex.}
\theoremseparator{}
\theoremindent0.0cm
\theoremstyle{nonumberplain}
\theoremheaderfont{\scshape}
\theoremsymbol{$\square$}
\newtheorem{proof}{Proof}

%-----------------------------------------------------------------------------------------------------------------
% Define Document Variables
\newcommand{\assignmentname}{Course Notes}
\newcommand{\classname}{Real Functions and Measures}
\newcommand{\semester}{BSM Fall 2018}

% Define a title page for the document
%----------------------------------------------------------------------------------------------------------------------
% Define headings for each page
\usepackage{fancyheadings}
\pagestyle{fancy}
\lhead{Alex Rutar\\arutar@uwaterloo.ca}
\rhead{\classname: \assignmentname\\\semester}
\cfoot{\thepage}
\setlength{\headheight}{50pt}
%----------------------------------------------------------------------------------------------------------------------
\begin{document}
\pagenumbering{roman}
\begin{titlepage}
    \centering
    \vspace{5cm}
    {\huge\textbf{\assignmentname}\par} % Assignment Name
    \vspace{2cm}
    {\Large\textbf{\classname}\par} % Class
    \vspace{3cm}
    {\Large\textit{Alex Rutar}\par}

    \vfill

% Bottom of the page
    {\large \semester \par} % Due Date
\end{titlepage}
%----------------------------------------------------------------------------------------------------------------------
% \newpage\null\thispagestyle{empty}\textit{This page is left intentionally blank.}\newpage
\pagenumbering{roman}
\tableofcontents
\pagenumbering{arabic}
\chapter{Basics of Abstract Measure Theory}
Prof contact: simonp@caesar.elte.hu
Grading: HW each week for 25\%
Midterm 30\%
Final 45\%

\section{Review of Topology}
\subsection{Basic Definitions}
\begin{definition}
    Let $X\neq\emptyset$ and $\tau\subseteq\mathcal{P}(X)$.
    We say that $(X,\tau)$ is a \textbf{topological space} if $\tau$ satisfies the following conditions:
    \begin{enumerate}
        \item $\emptyset\in\tau$ $X\in\tau$
        \item $V_1,V_2\in\tau\Rightarrow V_1\cap V_2\in\tau$
        \item $V_\alpha\in\tau$ for all $\alpha\in I\Rightarrow\bigcap\limits_{\alpha\in I}V_\alpha\in\tau$
    \end{enumerate}
    We call the elements of $\tau$ \textbf{open sets}.
\end{definition}
\begin{definition}
    $U\subseteq X$ is a \textbf{neighbourhood} of $x\in X$ if there is some $G\in\tau$ such that $x\in G\subset U$.
\end{definition}
\begin{definition}
    $F\subseteq X$ is \textbf{closed} if $F^c$ is open.
\end{definition}
\begin{definition}
    The \textbf{closure} of a set $E\subset X$ is the smallest closed set containing $E$ (denoted $\overline{E}$).
\end{definition}
\begin{definition}
    $x$ is an \textbf{accumulation point} of $H$ if all neighbourhoods of $x$ contains infinitely points of $H$.
    Equivalently, $x$ is a limit point of $H\setminus\{x\}$.
\end{definition}
\begin{definition}
    If $H\subseteq X$, we have a natural subspace topology $\tau|_H=\{G\cap H:G\in\tau\}$.
\end{definition}
\subsection{Examples of Topological Spaces}
Topological spaces are a very general construction, so here are some of the standard examples:
\begin{enumerate}
    \item $\R$ along with the open sets (denoted $\tau_e$, the Euclidean topology).
    \item The discrete topology, $\tau=\mathcal{P}(X)$ for any $X\neq\emptyset$.
        This is the ``finest'' topology.
    \item The antidiscrete topology, $\tau=\{\emptyset,X\}$ for any $X\neq\emptyset$
        This is the ``coarsest'' topology.
    \item One can define the extended real line, $X=\R\cup\{-\infty,+\infty\}$.
        Then
        \[G\in\tau\Leftrightarrow
            \begin{cases}
                \forall x\in G\cap\R & \exists r>0 \text{ s.t. } (x-r,x+r)\subset G\\
                -\infty\in G & \exists b\in\R \text{ s.t. }(-\infty,b)\subset G\\
                +\infty\in G & \exists a\in\R \text{ s.t. }(a,\infty)\subset G
            \end{cases}
        \]
        The same can be done with a single symbol as well.
        In either case, the extended real line is a compact set.
    \item Any metric spaces induces a topology.
        Consider a set $X\neq 0$ arbitrary, and let $d:X\times X\to\R$ such that
        \begin{enumerate}
            \item $0\leq d(x,y)$ for all $x,y\in X$ and $d(x,y)=0\Leftrightarrow x=y$.
            \item $d(x,y)=d(y,x)$ for all $x,y\in X$
            \item $d(x,y)\leq d(x,z)+d(z,y)$ for any $x,y,z\in X$
        \end{enumerate}
        Then $G\in \tau$ if and only if for any $x\in G$, there exists $r$ so that $B_r(x)\subset G$.
        There are many examples of metric spaces:
        \begin{enumerate}
            \item $X=\R$, $d(x,y)=|x-y|$
            \item $X=\R$, $d(x,y)=|\tan^{-1}(x)-\tan^{-1}(y)|$
            \item $X=\R^2$, $d(x,y)=\sqrt{(x_1-y_1)^2+(x_2-y_2)^2}$
            \item $X=\R^2$, $d(x,y)=\left(|x_1-y_1|^p+|x_2-y_2|^p\right)^{1/p}$ for $p\geq1$.
            \item and similarly for $X=\R^n$
            \item $X=C[0,1]$, $d(f,g)=\max_{x\in[0,1]} |f(x)-g(x)|$.
            \item normed space: $X$ is a vector space over $\R$, $\norm{\cdot}:X\to\R$ such that
                \begin{enumerate}
                    \item $\norm{x}=0$ if and only if $X=0$
                    \item $\norm{cx}=|c|\norm{x}$
                    \item $\norm{x+y}\leq\norm{x}+\norm{y}$
                \end{enumerate}
                If $\norm{\cdot}$ is a norm, then $d(x,y)=\norm{x-y}$ is a metric.
        \end{enumerate}
    \item The cofinite topology: $\tau=\{U\in\mathcal{P}(X):U^c\text{ is finite}\}$.
\end{enumerate}
\subsection{Other Definitions}
\begin{definition}
    $K\subset X$ is \textbf{compact} if every open cover of $K$ contains a finite subcover.
\end{definition}
\begin{definition}
    A topological space is called \textbf{locally compact} if every point has a compact neighbourhood.
\end{definition}
\begin{proposition}
    $C[0,1]$ with the sup norm is not locally compact.
\end{proposition}
\begin{proof}
    I'll do this later.
\end{proof}
\begin{definition}
    A topological space is called \textbf{Hausdorff} if for any $x\neq y$, there exists neighbourhoods $U\ni x$, $V\ni y$ so that $U\cap V=\emptyset$.
\end{definition}
The anti-discrete topology is not Hausdorff.
\begin{enumerate}[nolistsep]
    \item On the discrete topology, $K$ is compact if and only if $K$ is finite.
    \item On the anti-discrete topology, everything is compact (the only possible open cover consists of $X$).
    \item On $(\R,\tau_e)$, $K$ is compact if and only if $K$ is closed and bounded.
    \item On $(X,d)$ metric space, $K$ is compact if and only if $K$ is complete and totally bounded.
\end{enumerate}
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item Let $K\subset X$ be compact, let $F\subset K$ closed.
            Then $F$ is also compact.
        \item Compact sets in a Hausdorff space are closed.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[nolistsep]
        \item Let $F\subset\bigcup V_\alpha$.
            Then $K\subset F^c\cup \left(\bigcup V_\alpha\right)$ is an open cover for $K$, so it has a finite subcover $F^c\cup V_{\alpha_1}\cup\cdots V_{\alpha_n}$.
            But then since $F\cap F^c=\emptyset$, $F\subset V_{\alpha_1}\cup\cdots V_{\alpha_n}$ is a finite subcover.
        \item Let $K\subset X$ be compact, and prove that $K^c$ is open.
            Thus let $x\in K^c$.
            For any $y\in K$, there exist $U_y,V_y$ disjoint neighbourhoods of $x$ and $y$ respectively.
            Now consider the open cover $K\subset\bigcup_{y\in K}V_y$, and get our finite subcover $K\subset V_{y_1}\cup\cdots\cup V_{y_n}$.
            But then $U_{y_1}\cap\cdots\cap U_{y_n}\cap K=\emptyset$ and is open since it is a finite intersection.
    \end{enumerate}
\end{proof}
\begin{definition}
    $\Gamma\subseteq\tau$ is a \textbf{base} for $\tau$ if every $U\in\tau$ can be written as a countable union of the elements of $\Gamma$.
    $\Gamma$ is a \textbf{countable base} if $\Gamma$ is countable.
\end{definition}
\begin{proposition}
    $\R$ has a countable base of intervals.
\end{proposition}
\begin{proof}
    Consider the collection $\{B_{r}(q):(r,q)\in\Q\times\Q\}$.
    To see this, for any open set $U$, one can write
    \[S:=\bigcup\limits_{r\in U\cap\Q} \left(\bigcup\limits_{\{r:B_{r}(q)\subseteq U\}}B_{r}(q)\right)\]
    $U\supseteq S$ is obvious, so let $x\in U$ be arbitrary, and let $s$ be maximal so that $B_s(x)\subseteq U$.
    Then choose $q\in\Q$ so that $|x-q|<s/3$ and $r\in\Q$ so that $0<r<s/2$.
    Then by construction $B_{r}(q)\ni x$ and by the triangle inequality $B_{r/2}(q)\subseteq U$, so $x\in S$.
    Thus $U=S$ as desired.
\end{proof}
Note that the exact same argument (with some work) can be generalized to show that $\R^n$ has a countable base of open hyperrectangles.
\begin{proposition}
    Every metric space which is a countable union of compact sets has a countable base.
\end{proposition}
\begin{proof}
    See my PMATH 351 notes.
\end{proof}
\subsection{Functions and Continuity}
Many of the standard notions of limits and continuity extend naturally to topological spaces.
\begin{definition}
    Let $(x_n)\subset X$ be a sequence and let $x\in X$.
    Then $x$ is the \textbf{limit} of $(x_n)$ if for any neighbourhood $U$ of $X$, there exists $N\in\N$ such that $n>N\Rightarrow x_n\in U$.
\end{definition}
\begin{proposition}
    If $F\subset X$ is closed, then for all convergent sequences in $F$, the limit is also in $F$.
\end{proposition}
\begin{proof}
    See Homework.
\end{proof}
\begin{definition}
    Let $f:X\to Y$ be a function, and $x\in X$ an accumulation point of $D(f)$.
    The limit of $f$ at $x$ is $y\in Y$ if for any neighbourhood $V$ of $y$ there exists a neighbourhood $U$ of $x$ such that $f(U\cap D(f)\setminus\{x\})\subseteq V$.
\end{definition}
\begin{definition}
    Let $f:X\to Y$ be a function, and let $x\in D(f)$.
    Then $f$ is \textbf{continuous at $x$} if for any neighbourhood $V$ of $f(x)$, then $f^{-1}(V)$ is a neighbourhood of $x$.
\end{definition}
\begin{definition}
    $f:X\to Y$ is called \textbf{continuous} if it is continuous at every point.
\end{definition}
\begin{proposition}
    $f:X\to Y$ is continuous if and only if $f^{-1}(G)$ is open for all $G$ open.
\end{proposition}
\begin{proof}
    Exercise.
\end{proof}
\begin{theorem}
    Let $f:X\to Y$ be continuous and $K\subset X$ be compact.
    Then $f(K)$ is compact.
\end{theorem}
\begin{proof}
    Recall that continuous functions pull back open sets.
    Let $f(K)\subset\bigcup U_\alpha$ be an open cover.
    Then $\bigcup f^{-1}(U_\alpha)$ is an open cover for $K$, and has a finite subcover $U_{\alpha_1}\cup\cdots U_{\alpha_n}$.
    But then $f(f^{-1}(U_{\alpha_1}))\cup\cdots \cup f(f^{-1}(U_{\alpha_n}))$ is a subcover of $f(K)$.
\end{proof}

\section{Measure Theory}
\subsection{$\sigma-$algebras}
\begin{definition}
    Let $X\neq\emptyset$ be a set.
    $\mathcal{M}\subset\mathcal{P}(X)$ is called a \textbf{$\sigma-$algebra} if
    \begin{enumerate}[nolistsep]
        \item $X\in \mathcal{M}$
        \item $A\in\mathcal{M}\Rightarrow A^c\in\mathcal{M}$
        \item If $A_n\in\mathcal{M}$ for all $n\in\N$, then $\bigcup\limits_{n\in\N}A_n\in\mathcal{M}$
    \end{enumerate}
    The pair $(X,\mathcal{M})$ is called a \textbf{measurable space}.
    The elements of $\mathcal{M}$ are called \textbf{measurable sets}.
\end{definition}
\begin{definition}
    Let $(X,\mathcal{M})$ be a measurable space, $(Y,\tau)$ be a topological space.
    Then $f:X\to Y$ is called \textbf{measurable} if $f^{-1}(V)\in\mathcal{M}$ for all $V\in\tau$.
\end{definition}
Here are some simple examples of $\sigma-$algebras.
\begin{example}
    \begin{enumerate}
        \item $\mathcal{M}=\{\emptyset,X\}$ is a $\sigma-$algebra.
        \item $\mathcal{P}(X)=\mathcal{M}$ is a $\sigma-$algebra.
        \item $\mathcal{M}=\{A\subset X:A\text{ or }A^c\text{ is countable.}\}$.
            To see this, given $A_n\in\mathcal{M}$, if everything is countable, then $\bigcup A_n$ is countable.
            If some $A_i$ is countable, then $(\bigcup A_n)^c=\bigcap A_n^c$ is countable, so $\bigcup A_n\in\mathcal{M}$.
    \end{enumerate}
    We will later see some proper exaples, like the $\sigma-$algebra of Lebesgue measurable sets.
\end{example}
We have the following properties of $\sigma-$algebras.
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item $\emptyset\in\mathcal{M}$
        \item $A_1,A_2,\ldots,A_n\in\mathcal{M}\Rightarrow A_1\cup A_2\cup\cdots \cup A_n\in\mathcal{M}$
        \item $A_n\in\mathcal{M}$ for all $n\in\N$ then $\bigcap_{n=1}^\infty A_n\in\mathcal{M}$
        \item $A,B\in\mathcal{M}\Rightarrow A\setminus B\in\mathcal{M}$
        \item $f$ is measurable, $H\subset Y$ is closed, then $f^{-1}(H)\in\mathcal{M}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}[nolistsep]
        \item $X\in\mathcal{M}\Rightarrow X^c\in\mathcal{M}$.
        \item We can extend this to a countable union by introduction $A_{n+i}=\emptyset$ for $i\in\N$.
        \item By DeMorgan's identities, $(\bigcap A_n)^c=\bigcup A_n^c\in\mathcal{M}$.
        \item $A\setminus B=A\cap B^c\in\mathcal{M}$.
        \item $H^c$ is open implies $f^{-1}(H^c)\in\mathcal{M}$.
            Then $f^{-1}(H)=(f^{-1}(H^c))^c\in\mathcal{M}$.
    \end{enumerate}
\end{proof}
\begin{proposition}
    Let $f:X\to Y$ be measurable, let $g:Y\to Z$ be continuous, then $g\circ f:X\to Z$ is measurable.
\end{proposition}
\begin{proof}
    Let $V\subset Z$ be open, so $g^{-1}(V)\subset Y$ is open, so $f^{-1}(g^{-1}(V))\in\mathcal{M}$ which is $(g\circ f)^{-1}(V)$.
\end{proof}
\begin{proposition}
    Let $(X,\mathcal{M})$ be a measurable space, $Y$ be a topological space.
    Let $\phi:\R^2\to Y$ be continuous.
    If $u,v:X\to\R$ are measurable, then $h(x)=\phi(u(x),v(x))$ is measurable.
\end{proposition}
\begin{proof}
    Define $f:X\to\R^2$ by $f(x)=(u(x),v(x))$
    We will see that $f$ is measurable, so that $h=\phi\circ f$ is measurable since $\phi$ is continuous.
    Let $I_1,I_2\subset\R$ be open intervals, so $R=I_1\times I_2$ is an open rectangle.
    Then $f^{-1}(R)=u^{-1}(I_1)\cap v^{-1}(I_2)\in\mathcal{M}$.
    Let $G\subset\R^2$ be an open set, so there exist $R_n$ open rectangles so that
    \[G=\bigcup_{n=1}^\infty R_n\Rightarrow f^{-1}(G)=\bigcup\limits_{n=1}^\infty f^{-1}(R_n)\in\mathcal{M}\]
    so that $f$ is measurable.
\end{proof}
\begin{corollary}
    \begin{enumerate}[nolistsep]
        \item If $u,v:X\to\R$ are measurable, then $u+v$ and $u\cdot v$ are measurable.
        \item $u+iv:X\to\C$ is measurable.
        \item $f:X\to\C$ is measurable, $f=u+iv\Rightarrow u,v,|f|$ are measurable.
    \end{enumerate}
\end{corollary}
\begin{proposition}
    Define
    \[\chi_E(x)=
        \begin{cases}
            1\text{ if }x\in E\\
            0\text{ if }x\notin E
        \end{cases}
    \]
    Then $\chi_E$ is measurable if and only if $E\in\mathcal{M}$.
\end{proposition}
\begin{proof}
    Naturally, $\chi_E^{-1}(1)=E$ and $\chi_E^{-1}(0)=E^c$, so $\chi_E$ is measurable if and only if $E,E^c\in\mathcal{M}$.
\end{proof}
\begin{theorem}
    Let $\mathcal{F}\subset\mathcal{P}(X)$, then there exists a smallest $\sigma-$algebra containing $\mathcal{F}$.
    This is denoted by $S(\mathcal{F})$, the \textbf{$\sigma-$algebra generated by $\mathcal{F}$}.
\end{theorem}
\begin{proof}
    Let $\Omega=\{\mathcal{M}:\mathcal{M}\text{ is a $\sigma-$algebra, }\mathcal{F}\subset M\}$.
    Certainly $\Omega\neq\emptyset$ since $\mathcal{P}(X)\in\Omega$.
    Let $S(\mathcal{F})=\bigcap_{\mathcal{M}\in\Omega}\mathcal{M}$.
    We will see that $S(\mathcal{F})$ is a $\sigma-$algebra.
    \begin{enumerate}[label=(\roman*),nolistsep]
        \item Since $X\in\mathcal{M}$, it follows that $X\in\cap\mathcal{M}$.
        \item If $A\in S(\mathcal{F})$, then $A\in\mathcal{M}$ for all $\mathcal{M}$.
            Thus $A^c\in\mathcal{M}$ for all $\mathcal{M}$ and $A^c\in\cap\mathcal{M}$.
        \item In the same way, of $A_n\in S(\mathcal{F}$ for all $n$, then $A_n\in\mathcal{M}$ for all $n,\mathcal{M}$.
            Thus $\bigcup A_n\in\mathcal{M}$ for all $\mathcal{M}$ so $\bigcup A_n\in\mathcal{M}\in \bigcap \mathcal{M}=S(\mathcal{F})$.
    \end{enumerate}
    By definition, $\mathcal{F}\subset\bigcap\mathcal{M}$.
    Finally, $S(\mathcal{F})$ is minimal, since if $\mathcal{F}\subset\mathcal{N}$ is a $\sigma-$algebra, then $\mathcal{N}\in\Omega\Rightarrow S(\mathcal{F})\subset\mathcal{N}$, so we are done.
\end{proof}
\begin{definition}
    Let $(X,\tau)$ be a topological space.
    Then $\mathcal{B}=S(\tau)$ is called the \textbf{Borel $\sigma-$algebra}.
    Borel sets are the elements of $S(\tau)$.
    A function $f:X\to Y$ is Borel measurable if $f^{-1}(G)\in\mathcal{B}$ for all $G\subset Y$ open.
\end{definition}
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item If $F\subset X$ is closed, then $F\in\mathcal{B}$.
        \item $G_n\subset X$ are open, then $\bigcap_{n=1}^\infty G_n\in B$.
            These are called $G_\delta-$sets.
        \item $F_n\subset X$ are closed, then $\bigcup_{n=1}^\infty F_n\in B$.
            These are called $F_\sigma-$sets.
    \end{enumerate}
\end{proposition}
\begin{proof}
    These follow directly from the definition of a $\sigma-$algebra.
\end{proof}
\begin{example}
    $X=\R,\tau_e$, then $\mathcal{B}=S(\tau_e)$.
    Let $\Gamma_0=\{(a,b):a<b\}$ be a family of open intervals.
    We see that $S(\Gamma_0)=\mathcal{B}$.
    Since $\Gamma_0\subset\tau$, $S(\Gamma_0)\subset S(\tau)=\mathcal{B}$.
    Conversely, let $G\in\tau$, then we have open intervals $G=\bigcup_{n=1}^\infty I_n$ so that $G\in S(\Gamma_0)$.
    Thus $S(\tau)\subset S(\Gamma_0)$ and $S(\Gamma_0)=\beta$.
\end{example}
\begin{example}
    Let $\Gamma_\infty=\{(a,\infty):a\in\R\}$.
    I claim that $S(\Gamma_\infty)=\mathcal{B}$.
    Certainly $S(\Gamma_\infty)\subset S(\tau)=\mathcal{B}$.
    Then $(-\infty,a]=(a_1,\infty)^c\in S(\Gamma_\infty)$.%)
    Similarly, $(-\infty,a)=\bigcup_{n=1}^\infty (-\infty,a-1/n]\in S(\Gamma_\infty)$.%)
    Thus $(a,\infty)\cap(-\infty,b)=(a,b)\in S(\gamma_0)$, and using the previous example, $\mathcal{B}=S(\Gamma_\infty)$.
\end{example}
\begin{proposition}
    Let $(X,\mathcal{M})$ be a measurable space, and let $f:X\to\overline{\R}=\R\cup\{-\infty,\infty\}$ with the eucildean topology.
    If $f^{-1}((\alpha,\infty])\in\mathcal{M}$ for any $\alpha\in\R$, then $f$ is measurable. %)
\end{proposition}
\begin{proof}
    Recall that $f$ is measurable if its inverse image takes open sets to measurable sets.

    We have $f^{-1}([-\infty,\alpha])=(f^{-1}( (\alpha,\infty])^c\in\mathcal{M}$. %)
    Similarly,
    \begin{equation*}
        f^{-1}([-\infty,\alpha))=f^{-1}\left(\bigcap_{n=1}^\infty[-\infty,\alpha-1/n]\right)=\bigcup_{n=1}^\infty f^{-1}([-\infty,\alpha-1/n])\in\mathcal{M}
    \end{equation*} %]
    We then have
    \[f^{-1}((\alpha,\beta)=f^{-1}([-\infty,\beta)\cap(\alpha,\infty])=f^{-1}([-\infty,\beta))\cap f^{-1}((\alpha,\infty])\in\mathcal{M}\]%)]
    Recall that the open intervals are a base for $\tau_e$.
    Thus if $G\subset\overline{\R}$ is open, then there exists open intervals so that $G=\bigcup_{n=1}^\infty I_n$ and
    \begin{align*}
        f^{-1}(G)=f^{-1}\left(\bigcup_{n=1}^\infty I_n\right)=\bigcup_{n=1}^\infty f^{-1}(I_n)\in\mathcal{M}
    \end{align*}
    as desired.
\end{proof}
\subsection{Sequences of Measurable Functions}
Our goal is to prove that the pointwise limit of measurable functions is measurable.
This does not hold for Riemann integrability!
For example, a function with a finite number of discontinuities is Riemann integrable, but the dirichlet function is not Riemann integrable and is discontinuous only at a countable number of points.
\begin{definition}
    Let $(a_n)_{n\in\N}\subset\overline{R}$ be a sequence, and $b_k=\sup\{a_k,a_{k+1},\ldots\}$.
    Then $\beta=\inf_{k\in\N}b_k$ is called the $\lim\sup$ of $(a_n)$.
    We can similarly define $c_k=\inf\{a_k,a_{k+1},\ldots\}$ and $\lim\inf=\sup_{k\in\N}c_k$.
\end{definition}
\begin{definition}
    Let $f_n:X\to\overline{\R}$ be a sequence of functions.
    Then $(\sup f_n):X\to\overline{\R}$, $(\sup f_n)(x)=\sup f_n(x)$ for all $x\in X$.
    Similarly, $(\inf f_n):X\to\overline{\R}$, $(\inf f_n)(x)=\inf f_n(x)$ for all $x\in X$.
    Then $(\lim\inf f_n)(x)=\lim\inf f_n(x)$.
    If $\lim f_n(x)$ exists for all $x$, then we say $(\lim f_n)(x)=\lim f_n(x)$.
\end{definition}
\begin{theorem}
    Let $f_n:X\to\overline{R}$ be measurable.
    Then $\sup f_n$, $\inf f_n$, $\lim\sup f_n$, $\lim\inf f_n$ are measurable.
\end{theorem}
\begin{proof}
    Let $g=\sup f_n$.
    It is enough to prove that $g^{-1}((\alpha,+\infty])\in\mathcal{M}$ for all $\alpha$.
    Let $H=g^{-1}((\alpha,+\infty])=\{x\in X:\sup f_n(x)>\alpha\}$.
    Let $H_n=f_n^{-1}((\alpha,+\infty])=\{x\in X:f_n(x)>\alpha\}\in\mathcal{M}$.
    We show that $H=\bigcup\limits_{n=1}^\infty H_n$.

    First let $x\in H$, so $\sup f_n(x)>\alpha$.
    Thus get $N$ so that $f_N(x)>\alpha$, so $x\in H_N$ and $x$ is in the union.
    The converse is obvious.

    Thus $g$ is measureable.
    In the exact same way, $\inf f_n$ is measurable.
    As well,
    \[\lim\sup f_n=\inf_i\sup_{k\geq i}f_k\]
    is measurable.
\end{proof}
\begin{corollary}
    If $\lim f_n$ exists, then it is measurable.
\end{corollary}
\begin{proof}
    If $\lim f_n$ exists, then $\lim f_n=\lim\sup f_n$.
\end{proof}
\begin{corollary}
    If $f,g$ are measurable, then $\max\{f,g\}$, $\min\{f,g\}$ are measurable.
\end{corollary}
\begin{corollary}
    Let $f$ be a function.
    Then $f_+=\max\{f,0)\}$ and $f_-=-\min\{f,0\}$ (the positive and negative parts of $f$) are measurable.
    Similarly, $|f|=f_++f_i$ is measurable.
\end{corollary}
\subsection{Measures}
\begin{definition}
    Let $(X,\mathcal{M})$ be a measurable space.
    A function $\mu:\mathcal{M}\to[0,+\infty]$ is called a \textbf{(positive) measure} if it is countably additive and not constant $+\infty$.
    In other words,
    \begin{enumerate}
        \item $\mu\left(\bigcup\limits_{n=1}^\infty A_n\right)=\sum\limits_{n=1}^\infty \mu(A_n)$ if $A_i\cap A_j=\emptyset$
        \item $\exists A\in\mathcal{M}$ so that $\mu(A)<\infty$
    \end{enumerate}
    $(X,\mathcal{M},\mu)$ is called a \textbf{measure space}.
\end{definition}
\begin{proposition}
    \begin{enumerate}[nolistsep]
        \item $\mu(\emptyset)=0$
        \item If $A_i\cap A_j=\emptyset$ then $\mu\left(\sum\limits_{i=1}^n A_i\right)=\sum\limits_{i=1}^n\mu(A_i)$
        \item $A\subset B$ implies $\mu(A)\leq\mu(B)$
        \item $A_1\subset A_2\subset A_3\cdots$ then $\lim_{n\to\infty}\mu A_n=\mu\left(\bigcup\limits_{n=1}^\infty A_n\right)$
        \item $A_1\supset A_2\supset A_3\cdots$ and $\mu(A_i)<\infty$ then $|lim_{n\to\infty}\mu(A_n)=\mu\left(\bigcap\limits_{n=1}^\infty A_n\right)$
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Let $A\in\mathcal{M}$ so that $\mu(A)<\infty$, and fix $A_1=A$, $A_2=A_3=\cdots=\emptyset$.
            Then $\bigcup A_n=A$ so $\mu(A)=\mu(A)+\sum\limits_{i=2}^\infty \mu(\emptyset)$ so $\mu(\emptyset)=0$.
        \item Obvious
        \item Note that $B=A\cup(B\setminus A)$ is a disjoint union.
        \item Define $B_1:=A_1$ and $B_i=A_i\setminus A_{i-1}$ for $i\geq 2$.
            Then $B_i\cap B_j=\emptyset$ and $\mu(A_n)=\mu\left(\bigcup\limits_{i=1}^n B_i\right)=\sum\limits_{i=1}^\infty\mu(B_i)$.
            Similary, $\mu\left(\bigcup\limits_{n=1}^\infty A_n\right)=\mu\left(\bigcup\limits_{n=1}^\infty B_n\right)=\sum\limits_{n=1}^\infty\mu(B_n)$
            Therefore, $\lim_{n\to\infty}\sum\limits_{i=1}^n \mu(B_i)=\sum\limits_{n=1}^\infty \mu(B_n)$.
        \item Let $C_n=A_1\setminus A_n$, $C_1=\emptyset$.
            Then $C_1\subset C_2\subset\cdots$ and $\mu(C_n)+\mu(A_n)=\mu(A_1)$.
            Let $A=\bigcap\limits_{n=1}^\infty A_n$ so $A_1\setminus A=\bigcup\limits_{n=1}^\infty C_n$ and $(\bigcup C_n)\cup A=A_1$ is a disjoint union.
            But then $\mu(\bigcup A_n)+\mu(A)=\mu(A_1)$ so that
            \[\mu(A_1)-\mu(A)=\mu(\bigcup C_n)=\lim_{n\to\infty}\mu(C_n)=\mu(A_n)-\lim \mu(A_n)\]
            Since $\mu(A_1)$ is finite, we have $\mu(A)=\lim\mu(A_n)$.
    \end{enumerate}
\end{proof}
\begin{example}
    Here are a few examples of measures that exist on arbitrary sets.
    \begin{enumerate}
        \item $X$ arbitrary, $\mathcal{M}=\mathcal{P}(X)$, and
            \[\mu(E)=\begin{cases}|E|&\text{if $E$ is finite}\\+\infty&\text{if $E$ is not finite}\end{cases}\]
            It is easy to verify it is countably additive.
        \item $X$ arbitrary, $\mathcal{M}=\mathcal{P}(X)$.
            Fix $x_0\in X$.
            Then
            \[\mu(E)=\begin{cases}1&\text{if $x_0\in E$}\\0&\text{if $x_0\notin E$}\end{cases}\]
    \end{enumerate}
\end{example}
\section{Towards Integration}
\subsection{Simple Functions}
\begin{definition}
    $s:X\to\R$ or $\C$ is called a \textbf{simple function} if its range is finite.
\end{definition}
\begin{proposition}
    Let $s$ be a simple function, so that $R(s)=\{\alpha_1,\alpha_2,\ldots,\alpha_n\}$.
    Then $s=\sum\limits_{i=1}^n \alpha_i\chi_{A_i}$ where $A_i=s^{-1}(\{\alpha_i\})$ and $s$ is \textbf{measurable} if and only if $A_i\in\mathcal{M}$.
\end{proposition}
\begin{proof}
    Obvious.
\end{proof}
The following theorem is used later to define the intergral.
It is clear that we should define the integral of a simple function as the sum of the integrals of its characteristic functions, and this allows us to extend the integral by limits to the function $f$.
\begin{theorem}
    Let $f:X\to[0,+\infty]$ be nonnegative measurable functions.
    Then there exists a sequence $s_n:X\to[0,+\infty]$ of simple measurable functions with
    \begin{enumerate}[nolistsep]
        \item $(s_n)$ is increasing and bounded above by $f$
        \item $\lim s_n=f$ pointwise.
    \end{enumerate}
\end{theorem}
\begin{proof}
    Let $n\in\N$, $t\geq0$, and define $k_n(t)=[2^{n}\cdot t]$ (i.e. $k_n(t)\leq 2^{n}\cdot t<k_n(t)+1$).
    Then define
    \[\phi_n(t)=\begin{cases}k_n(t)\cdot 2^{-n}&\text{if }t\leq n\\n&\text{if }t>n\end{cases}\]
    I've drawn $\phi_1$ below:
    \begin{center}
        \begin{tikzpicture}[scale=3]
            \draw (0,-0.5) -- (0,1.5);
            \draw (-0.5,0) -- (2,0);
            \node[circle,draw=black, inner sep=2pt] (a) at (0.5,0){};
            \node[circle,fill=black, inner sep=2pt] (b) at (0.5,0.5){};
            \node[circle,draw=black, inner sep=2pt] (c) at (1,0.5){};
            \node[circle,fill=black, inner sep=2pt] (d) at (1,1){};

            \draw[thick] (0,0) -- (a);
            \draw[thick] (b) -- (c);
            \draw[thick] (d) -- (2,1);
        \end{tikzpicture}
    \end{center}
    Then $t-2^{-n}\leq\phi_n(t)\leq t$, $\lim\phi_n(t)=t$ uniformly, and $\phi_n\leq \phi_{n+1}$, so the sequence of functions is monotone.
    Define $s_n=\phi_n\circ f$, so for any $x\in X$, $\lim s_n(x)=\lim \phi_n\circ f(x)=f(x)$.
    Note that $s_n$ is simple since it has finite range (from $\phi_n$), and $s_n\leq s_{n+1}$ because $\phi_n\leq \phi_{n+1}$, and $s_n\leq f$ since $\phi_n(t)\leq t$.
    Furthermore, $\phi_n$ is measurable since its level sets are intervals, so $s_n=\phi_n\circ f$ is measurable.
\end{proof}
\subsection{Integration of Positive Functions}
\begin{definition}
    Let $s:X\to[0,+\infty)$ be a measurable simple function $s=\sum\limits_{n=1}^N\alpha_i X_{A_i}$. %]
    Let $E\in\mathcal{M}$.
    Then define the \textbf{integral} of $s$ over $E$ with respect to $\mu$ as
    \[\int_E s\d{\mu}=\sum\limits_{n=1}^N\alpha_i\mu(A_i\cap E)\]
    where we define $0\cdot\infty=0$.
\end{definition}
\begin{definition}
    Let $f:X\to[0,+\infty]$ be a measurable function.
    Let $E\in\mathcal{M}$.
    Then the \textbf{(Lebesgue) integral} of $f$ over $E$ with respect to $\mu$ is
    \[\int_E f\d{\mu}=\sup\left\{\int_E s\d{\mu}:0\leq s\leq f;\text{ $s$ is simple measurable}\right\}\]
\end{definition}
Unlike the Riemann integral, we take the supremum over lower sums only.
\begin{proposition}
    Let $f,g:X\to[0,+\infty]$ be measurable functions.
    Let $E,A,B\in\mathcal{M}$.
    \begin{enumerate}[nolistsep]
        \item If $f\leq g$ then $\int_E f\d{\mu}$ and $\int_E g\d{\mu}$
        \item If $A\subset B$, then $\int_A f\d{\mu}\leq \int_B f\d{\mu}$
        \item $\int_E c\cdot f\d{\mu}=c\cdot\int_E f\d{\mu}$ for all $c\geq 0$
        \item If $f(x)=0$ for all $x\in E$, then $\int_E f\d{\mu}=0$
        \item If $\mu(E)=0$, then $\int_E f\d{\mu}=0$
        \item $\int_E f\d{\mu}=\int_X f\cdot \chi_E\d{\mu}$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Note that
            \begin{equation*}
                \left\{\int_E s\d{\mu}:0\leq s\leq f\right\}\subset\left\{\int_E s\d{\mu}:0\leq s\leq g\right\}
            \end{equation*}
        \item Let $0\leq s\leq f$ be simple measurable.
            Then
            \[\int_A s\d{\mu}=\sum\limits\alpha_i\mu(A\cap A_i)\leq \sum\alpha_i\mu(B\cap A_i)=\int_B s\d{mu}\]
            Take the supremum for all $0\leq s\leq f$, then the result follows.
        \item Let $S$ be simple and measurable, so $s=\sum \alpha_i\chi_{A_i}$.
            Then
            \[\int_Ec\cdot s\d{\mu}=\sum\limits_{i=1}^n\alpha_I\cdot c\cdot \mu(E\cap A_i)=c\cdot\sum\alpha_i\mu(E\cap A_i)=c\int_Es\d{\mu}\]
            Thus
            \begin{align*}
                \int_Ec\cdot f\d{\mu}&=\sup\left\{\int_E s\d{\mu}:0\leq s\leq cf\right\}\\
                                     &=\sup\left\{\int_E c\cdot t\d{\mu}:0\leq t\leq f\right\}\\
                                     &=c\cdot\sup\left\{\int_E t\d{\mu}:0\leq t\leq f\right\}\\
                                     &= c\cdot\int_E f\d{\mu}
            \end{align*}
        \item If $0\leq s\leq f$, then $s=\sum \alpha_i\chi_{A_i}$.
            If $x\in A_i\cap E$, then $s(x)=\alpha_i$ and $\alpha_i=0$.
            Then $\alpha_i\mu(A_i\cap E)=0$ for all $i$: either $A_i\cap E=\emptyset$, or $A_i\cap E$ is not empty, and $\alpha_i=0$.
            This is true for any $0\leq s\leq f$, and taking supremums yields the result.
        \item If $\mu(E)=0$ then $\mu(A_i\cap E)=0$, and $\int_E s\d{\mu}=\sum\alpha_i\mu(A_i\cap E)=0$ and taking supremums, the result holds.
        \item Exercise.
            First prove if $0\leq s\leq f\cdot\chi_E$, then $\int_X s\d{\mu}=\int_E s\d{\mu}$.
            Then prove
            \begin{equation*}\left\{\int_E s\d{\mu}:0\leq s\leq f\cdot\chi_E\right\}=\left\{\int_E s\d{\mu}:0\leq s\leq f\right\}\end{equation*}
    \end{enumerate}
\end{proof}
\begin{proposition}
    Let $s$ be a simple and measurable.
    Then $\phi(E)=\int_Es\d{\mu}$ is a measure.
\end{proposition}
\begin{proof}
    $\phi(\emptyset)=0$, so $\phi$ is not constant $+\infty$.
    Let $E=\bigcup_{n=1}^\infty E_n$ be a disjoint union.
    Then
    \begin{align*}
        \phi(E) &=\sum\limits_{i=1}^m\alpha_i\mu(A_i\cap E)\\
                &=\sum\limits_{i=1}^m\alpha_i\mu\left(A_i\cap\left(\bigcup\limits_{n=1}^\infty E_n\right)\right)= \sum\limits_{i=1}^m\alpha_i\mu\left(\bigcup\limits_{n=1}^\infty(A_i\cap E_n)\right)\\
                &= \sum\limits_{i=1}^m\alpha_i\sum\limits_{n=1}^\infty\mu(A_i\cap E_n)= \sum\limits_{n=1}^\infty\sum\limits_{i=1}^m\alpha_i\mu(A_i\cap E_n)\\
                &= \sum\limits_{n=1}^\infty \int_{E_n}s\d{\mu}= \sum\limits_{n=1}^\infty \phi(E_n)
    \end{align*}
\end{proof}
\begin{proposition}
    Let $s,t$ be nonnegative, measurable simple functions.
    Then
    \[\int_X(s+t)\d{\mu}=\int_X s\d{\mu}+\int_X t\d{\mu}\]
\end{proposition}
\begin{proof}
    Write
    \[s=\sum\limits_{i=1}^m\alpha_i X_{A_i},\quad t=\sum\limits_{j=1}^n \beta_j X_{\beta_j}\]
    and let $E_{ij}=A_i\cap B_j$, so $X=\bigcup_{i,j} E_{ij}$ is a disjoint union.
    We now have
    \[\int_{E_{ij}}(s+t)\d{\mu}=(\alpha_i+\beta_j)\mu(E_{ij})=\alpha_i\mu(E_{ij})+\beta_j\mu(E_{ij})=\int_{E_{ij}}s\d{\mu}+\int_{E_{ij}}t\d{\mu}\]
    Let $\mu(E)=\int_E(s+t)\d{\mu}$, which is a measure as above.
    Thus
    \begin{align*}
        \int_X(s+t)\d{\mu} &= \phi(X)=\phi\left(\bigcup_{i,j}E_{ij}\right)\\
                           &= \sum\limits_{i,j}\phi(E_{ij})=\sum\limits_{i,j}\int_{E_{ij}}(s+t)\d{\mu}\\
                           &= \sum\limits_{i,j}\left(\int_{E_{ij}}s\d{\mu}+\int_{E_{ij}}t\d{\mu}\right)\\
                           &= \sum\limits_{i,j}\varphi(E_{ij})+\sum\limits_{i,j}\theta(E_{ij})\\
                           &= \int_Xs\d{\mu}+\int_X t\d{\mu}
    \end{align*}
    where $\varphi(E)=\int_E s\d{\mu}$, $\theta(X)=\int_E t\d{\mu}$.
\end{proof}
\subsection{Lebesgue's Monotone Convergence Theorem}
\begin{theorem}[Lebesgue's Monotone Convergence]
    Let $f_n:X\to[0,+\infty]$ be measurable, such that
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \item $0\leq f_1\leq f_2\leq\cdots$
        \item $f(x):=\lim_{n\to\infty} f_n(x)$ for all $x\in X$
    \end{enumerate}
    Then $f$ is measurable, and $\int_X f\d{\mu}=\lim_{n\to\infty}\int_X f_n\d{\mu}$.
\end{theorem}
\begin{proof}
    It was already proven that $f$ is measurable.
    We have $\int_X f_n\d{\mu}\leq \int_x f_{n+1}\d{\mu}$ for all $n$, so $\alpha:=\lim_{n\to\infty}\int_X f_n \d{\mu}$ exists.
    We also have $f_n\leq f$, so $\int f_n\leq \int f$ and $\alpha\leq\int_X f_n\d{\mu}$.
    Thus we wish to show $\alpha\geq \int_Xf\d{\mu}$.
    It suffices to prove that $\alpha\geq\int_X s\d{\mu}$ for any simple $s\leq f$.
    Furthermore, if $c\in(0,1)$, it suffices to show that $\alpha\geq\int_X c\cdot s\d{\mu}$.

    Define $E_n=\{x\in X:f_n(x)\geq c\cdot s(x)\}$.
    We have $E_1\subset E_2\subset\cdots$ so that $\bigcup\limits_{n=1}^\infty E_n=X$.
    Then
    \begin{equation*}
        \int_X f_n\d{\mu} \geq \int_{E_n} f_n\d{\mu}\geq \int_{E_n} c\cdot s\d{\mu}
    \end{equation*}
    Let $\phi(E)=\int_E s\d{\mu}$, so $\int_{E_n}s\d{\mu}=\phi(E_n)$.
    Thus $\lim_{n\to\infty}\phi(E_n)=\phi(X)=\int_X s\d{\mu}$.
    Thus
    \begin{equation*}
        \alpha\geq c\cdot \lim_{n\to\infty}\phi(E_n)=c\cdot\int_X s\d{\mu}=\int_X c\cdot s\d{\mu}
    \end{equation*}
    as desired.
\end{proof}
\begin{example}
    Consider the function consisting of a triangle with base $2/n$ and height $n$.
    Then $\int_0^1 f_n=1$ as a Riemannian integral.
    However, $\lim f_n(x)=0$ for any $x$, so $\int_0^1 f=0\neq 1=\lim \int_0^1 f_n$.
\end{example}
\begin{theorem}
    Let $f,g:X\to[0,+\infty]$ measurable, then $\int_X(f+g)\d{\mu}=\int_X f\d{\mu}+\int_X g\d{\mu}$.
\end{theorem}
\begin{proof}
    We proved that there exists increasing sequences of simple functions $s_n,t_n$ such that $\lim s_n(x)=f(x)$, $\lim t_n(x)=g(x)$.
    Then $s_n(x)+t_n(x)\to f(x)+g(x)$ monotonically.
    But then
    \begin{align*}
        \int_X(f+g)\d{\mu} &= \int_X \lim_{n\to\infty}(s_n+t_n)\d{\mu}\\
                           &= \lim_{n\to\infty}\int_X (s_n+t_n)\d{\mu}\\
                           &= \lim_{n\to\infty}\left(\int_X s_n\d{\mu}+\int_X t_n\d{\mu}\right)\\
                           &= \int_X \lim_{n\to\infty}s_n\d{\mu}+\int_X\lim_{n\to\infty} t_n\d{\mu}\\
                           &= \int_X f\d{\mu}+\int_X g(\d{\mu})
    \end{align*}
\end{proof}
\begin{corollary}
    If $f_n:X\to[0,+\infty]$ is a sequence of measurable functions, then
    \[\sum_{n=1}^\infty \int_X f_n\d{\mu}=\int_X\sum\limits_{n=1}^\infty f_n\d{\mu}\]
\end{corollary}
\begin{example}
    Let $X=\N$, $\mathcal{M}=\mathcal{P}(X)$, $\mu(E)$ is the counting measure.
    Let $a:X\to[0,\infty)$ be a function. %]
    This is a sequence.
    Every function is measurable.
    Let $s_n(i)=a(i)$ for $i\leq n$ and $0$ otherwise, which is a simple function, and $s_n\leq s_{n+1}$.
    Then $\lim_{n\to\infty}s_n(i)=a(i)$ so $s_n\to a$ pointwise, so by LMC $\int_X s_n\d{\mu}=\int_X a\d{\mu}$.
    Also,
    \[\int_X s_n\d{\mu}=\sum\limits_{i=1}^na(i)\mu(\{i\})=\sum\limits_{i=1}^na(i)\]
    so $\int_X a\d{\mu}=\sum\limits_{n=1}^\infty a(n)$.
\end{example}
\begin{lemma}[Fatou]
    Let $f_n:X\to[0,\infty)$ be a sequence of measurable functions.
    Then
    \[\int_X\lim\inf f_n\d{\mu}\leq\lim\inf\int_X f_n\d{\mu}\]
\end{lemma}
\begin{proof}
    Let $g_k=\inf\{f_k,f_{k+1},\ldots\}$ so $\lim\inf f_n=\lim_{n\to\infty} g_n$ and $g_n$ is increasing.
    Note that $g_k\leq f_k$ for any $k$, so $\int_x g_k\d{\mu}\leq\int_X f_k\d{\mu}$.
    Thus
    \begin{align*}
        \int_X\lim\inf f_n\d{\mu} &= \int_X\lim g_n\d{\mu}\\
                                  &= \lim\int_X g_n\d{\mu}\\
                                  &= \lim\inf \int_X g_n\d{\mu}\\
                                  &\leq \lim\inf\int_X f_n\d{\mu}
    \end{align*}
\end{proof}
\begin{example}
    It is possible for the inequality to be strict.
    Define $f_{2n}=\chi_{[0,1]}$ and $f_{2n+1}=\chi_{[1,2]}$.
    Thus $\lim\inf f_n(x)=0$ so $\int_{[0,2]}\lim\inf f_n\d{\mu}=0$ but $\inf_[0,2]\int_{[0,2]}f_n\d{\mu}=1$
\end{example}
\begin{theorem}
    Let $f:X\to[0,\infty]$ be measurable.
    Let $\phi(E)=\int_E f\d{\mu}$, $E\in\mathcal{M}$.
    Then $\phi$ is a measure and $\int_X g\d{\phi}=\int_X g\cdot f\d{\mu}$.
\end{theorem}
\begin{proof}
    Certainly $\phi(\emptyset)=0$, so $\phi\neq+\infty$.
    Thus let $E=\bigcup\limits_{i=1}^\infty E_i$ be a disjoint union.
    Then $\chi_E f=\sum\limits_{i=1}^\infty\chi_{E_i}f$.
    Thus we have
    \begin{align*}
        \phi(E) &= \int_Ef\d{\mu}\\
                &= \int_X\chi_E f\d{\mu}\\
                &= \int_X\sum\limits_{i=1}^\infty \chi_{E_i}f\d{\mu}\\
                &= \sum\limits_{i=1}^\infty\int_X\chi_{E_i}f\d{\mu}\\
                &= \sum\limits_{i=1}^\infty \int_{E_i}\d{\mu}\\
                &= \sum\limits_{i=1}^\infty\phi(E_i)
    \end{align*}
    Now, we prove that $\int_X g\d{\mu}=\int_Xgf\d{\mu}$.

    First, we do this for $g=\chi_E$.
    Then $\int_X\chi_E\d{\mu}=\phi(E)$ on the left, and $\int_X\chi_E f\d{\mu}=\int_E f\d{\mu}=\phi(E)$ and equality holds.

    Now, let $g=\sum\limits_{i=1}^n\alpha_i\chi_{A_i}$ be a simple function.
    Then $\int_X\sum\alpha_i\chi_{A_i}\d{\phi}=\sum\alpha_i\int_X\chi_{A_i}\d{\phi}$ on the left and $\int_X\sum\alpha_i\chi_{A_i}f\d{\mu}=\sum\alpha_i\int_X\chi_{A_i}f\d{\mu}$.

    Finally, let $g$ be an arbitrary measurable function, and let $(s_n)\to g$ be an increasing sequence of simple functions.
    Note that $s_nf\to gf$.
    Thus
    \begin{align*}
        \int_Xg\d{\phi}&=\int_X\lim s_n\d{\phi}=\lim\int_Xs_n\d{\phi}\\
                       &=\lim\int_Xs_n f\d{\mu}=\int_X\lim(s_nf)\d{\mu}\\
                       &=\int_Xg\cdot f\d{\mu}
    \end{align*}
    as desired.
\end{proof}
\section{Integration of Complex Valued Functions}
\begin{definition}
    A function $f:X\to\C$ is called \textbf{Lebesgue integrable} if $\int_X|f|\d{\mu}<\infty$.
    The collection of such functions is $L^1(\mu)$.
\end{definition}
\subsection{Basic Properties}
\begin{definition}
    Let $f\in L^1(\mu)$.
    Then $f=u+iv$ and denote $u=\re f$, $v=\im f$.
    Let $E\in\mathcal{M}$; then the integral of $f$ over $E$ with respect to $\mu$ is
    \[\int_Ef\d{\mu}=\int_Eu^+\d{\mu}-\int_E u^-\d{\mu}+i\left(\int_E v^+\d{\mu}-\int_E v^-\d{\mu}\right)\]
\end{definition}
\begin{theorem}
    Let $f,g\in L^1(\mu)$, $\alpha,\beta\in\C$, so $\alpha f+\beta g=L^1(\mu)$ and
    \[\int_X(\alpha f+\beta g)\d{\mu}=\alpha\int_X f\d{\mu}+\beta\int_X g\d{\mu}\]
\end{theorem}
\begin{proof}
    Note that $\alpha f+\beta g$ is measurable, so $\int_X|\alpha f+\beta g|\d{\mu}\leq |\alpha|\int_X|f|\d{\mu}+|\beta|\int_X|g|\d{\mu}<\infty$.
    For real measurable functions, $\int_X(f+g)\d{\mu}=\int_X f\d{\mu}+\int_X g\d{\mu}$ directly by expanding the definition and using additivity over positive functions.
    We thus show $\int_X\alpha f\d{\mu}=\alpha\int_Xf\d{\mu}$.
    If $\alpha\geq 0$, then
    \begin{align*}
        \int_X\alpha f\d{\mu}=\int_X\alpha(u+iv)&=\int_X(\alpha u^+-\alpha u^-+i\alpha v^+-i\alpha v^-)\d{\mu}\\
                                                &=\int_X((\alpha u)^+-(\alpha u)^-+(i\alpha v)^+-(i\alpha v)^-)\d{\mu}\\
                                                &=\int_X(\alpha u)^+\d{\mu}-\int_X(\alpha u)^-\d{\mu}+\int_Xi(\alpha v)^+\d{\mu}-\int_Xi(\alpha v)^-\d{\mu}\\
                                                &=\alpha\int_Xu^+\d{\mu}-\alpha\int_Xu^-\d{\mu}+\alpha\int_Xiv^+\d{\mu}-\alpha\int_Xiv^-\d{\mu}\\
                                                &= \alpha\int_X f\d{\mu}
    \end{align*}
    and similarly for $\alpha=-1$, $\alpha=i$.
\end{proof}
\begin{theorem}
    Let $f\in L^1(\mu)$.
    Then $\left\lvert\int_X f\d{\mu}\right\rvert\leq\int_X|f|\d{\mu}$.
\end{theorem}
\begin{proof}
    Let $z=\int_X f\d{\mu}$.
    Let $\alpha=\frac{|z|}{z}$ if $z\neq 0$, and $\alpha=1$ otherwise.
    Then $\alpha\int_X f\d{\mu}=|z|$.
    Let $u=\re(\alpha\cdot f)\leq |\alpha\cdot f|\leq |f|$ since $|\alpha|=1$.
    Thus
    \begin{align*}
        \left\lvert\int_X f\d{\mu}\right\rvert &= \alpha\cdot\int_X f\d{\mu}\\
                                               &=\int_X\alpha f\d{\mu}\\
                                               &= \int_X\re(\alpha f)\d{\mu}\\
                                               &\leq \int_X|f|\d{\mu}
    \end{align*}
\end{proof}
\subsection{More Dominated Convergence}
Naturally, we want similar results as we have before.
Indeed, we have the following theorem:
\begin{theorem}[Lebesgue's Dominated Convergence]
    Let $f_n:X\to\C$ be measurable functions such that $f=\lim f_n$.
    Assume that there is some $g\in L^1(\mu)$ such that $|f_n|\leq g$ for all $n$.
    Then $f\in L^1(\mu)$ and $\int_X f\d{\mu}=\lim_{n\to\infty}\int_X f_n\d{\mu}$.
\end{theorem}
\begin{proof}
    We certainly know that $f$ is measurable, and $|f|\leq g$, so $f\in L^1(\mu)$.
    As well, the triangle inequality show that $|f-f_n|\leq 2g$ for any $n$.
    We will see that $0\leq \lim\inf\int_X|f-f_n|\d{\mu}\leq\lim\sup\int_X|f-f_n|\d{\mu}\leq 0$.
    Assuming that this holds, then $\lim\int_X|f-f_n|\d{\mu}=0$ and
    \[0\leq\lim\left\lvert\int_Xf\d{\mu}-\int_Xf_n\d{\mu}\right\rvert\leq\int_X|f-f_n|\d{\mu}=0\]

    The first two inequalities are obvious: we must show that $\lim\sup\int_X|f_n|\d{\mu}\leq 0$.
    Firstly, we have
    \begin{align*}
        \int_X 2g\d{\mu} &= \int_X \left(2g-\lim_{n\to\infty}|f-f_n|\right)\d{\mu}\\
                         &= \int_X\lim\inf(2g-|f-f_n|)\d{\mu}\\
                         &\leq \lim\int\int_X(2g-|f-f_n|)\d{\mu} &&\text{By Fatou's Lemma}\\
                         &= \int_X 2g+\lim\inf\left(-\int_X|f-f_n|\d{\mu}\right)\\
                         &= \int_X 2g-\lim\sup \int_X|f-f_n|\d{\mu}
    \end{align*}
    and since $\int_X 2g\d{\mu}$ is finite, we subtract and $\lim\sup\int_X|f-f_n|\d{\mu}\leq 0$.
\end{proof}
\begin{example}
    Consider $\lim_{n\to\infty}\int_0^n e^{-nx}\d{x}$.
    Define
    \[f_n(x)=
        \begin{cases}
            e^{-nx}&\text{if }x\leq n\\
            0 &\text{if }x>n
        \end{cases}
    \]
    Note that $f_n(x)\leq g(x)=e^{-x}$ and $\int_0^\infty e^{-x}\d{x}<\infty$.
    Thus
    \begin{align*}
        \lim_{n\to\infty}\int_0^n e^{-nx}\d{x} &= \int_{[0,\infty)}\lim_{n\to\infty}f_n(x)\d{x}\\
                                               &= \int_{[0,\infty)]}\chi_{\{0\}}\d{x}\\
                                               &= 0
    \end{align*}
\end{example}
\begin{remark}
    For the Riemann integral, we have $\int\lim f_n=\lim\int f_n$ as long as the convergence of $f_n$ is uniform.
\end{remark}
\chapter{The Lebesgue measure}
\section{The Vector Space $L^1(\mu)$}
\subsection{Almost Everywhere}
Let $(X,\mathcal{M},\mu)$ be a measure space.
\begin{definition}
    Let $E\in\mathcal{M}$.
    We say that property $P$ holds almost everywhere in $E$ if there exists $N\in\mathcal{M}$ such that $\mu(N)=0$, $N\subset E$, and $P$ holds in $E\setminus N$.
\end{definition}
\begin{example}
    Two functions $f,g:X\to\C$ are equal almost everywhere if $\exists N\subset X$ such that $\mu(N)$ and $f(x)=g(x)$ on $X\setminus N$.
\end{example}
\begin{proposition}
    Let $E\subset X$ be such that $A_1,A_2,B_1,B_2\in\mathcal{M}$ for which $\int_X f\d{\mu}=\int_X g\d{\mu}$.
    Then $A_1\subset E\subset B_1$, $A_2\subset E\subset B_2$, and $\mu(B_1\setminus A_1)=0$ and $\mu(B_2\setminus A_2)=0$.
    Then $\mu(A_1)=\mu(A_2)$.
\end{proposition}
\begin{proof}
    Note that $A_1\setminus A_2\subset E\setminus A_2\subset B_2\setminus A_2$.
    As well, $\mu(A_1\setminus A_2)\leq \mu(B_2\setminus A_2)=0$.
    Then
    \begin{align*}
        \mu(A_1)&=\mu(A_1\cap A_2^c)+\mu(A_1\cap A_2)=\mu(A_1\setminus A_2)+\mu(A_1\cap A_2)=\mu(A_1\cap A_2)\\
        \mu(A_2)&=\mu(A_2\cap A_1^c)+\mu(A_2\cap A_1)=\mu(A_2\setminus A_1)+\mu(A_2\cap A_1)=\mu(A_1\cap A_2)
    \end{align*}
\end{proof}
\begin{proposition}
    Let $(X,\mathcal{M},\mu)$ be a measure space.
    Let
    \[\mathcal{M}^*=\{E\subset X:\exists A,B\in\mathcal{M}, A\subset E\subset B,\mu(B\setminus A)=0\}\]
    Then $\mathcal{M}^*$ is a $\sigma-$algebra, and $\mu^*:\mathcal{M}^*\to[0,+\infty]$ defined by $\mu^*(E)=\mu(A)$.
\end{proposition}
\begin{proof}
    We show that $\mathcal{M}^*$ is a $\sigma-$algebra, and $\mu$ is countably additive.
    \begin{enumerate}[nolistsep]
        \item $X\in\mathcal{M}$ so $X\in\mathcal{M}^*$.
        \item If $E\in\mathcal{M}^*$, get $A\subset E\subset B$ so $B^c\subset E^c\subset A^c$, $A^c,B^c\in\mathcal{M}$.
            As well, $\mu(A^c\setminus B^c)=\mu(A^c\cap B)=\mu(B\setminus A)=0$, so $E^c\in\mathcal{M}^*$.
        \item If $E_i\in\mathcal{M}^*$ is a countable collection, then get $A_i\subset E_i\subset B_i$.
            Fix $A=\bigcup A_i$ and $B=\bigcup B_i$.
            Then $B\setminus A=\bigcup(B_i\setminus A)\subset U(B_i\subset A_i)$ so $\mu(B\setminus A)=0$ and $A\subset\bigcup E_i\subset B$ so $\bigcup E_i\in\mathcal{M}^*$.
        \item Let $E_i$ be disjoint, $E=\bigcup E_i$, and $E_i\in\mathcal{M}^*$.
            Get $A_i\subset E_i\subset B_i$.
            Then $\mu^*(\bigcup E_i)=\mu(\bigcup A_i)=\sum\mu(A_i)=\sum\mu(E_i)$.
    \end{enumerate}
\end{proof}
\begin{definition}
    We call the space $(X,\mathcal{M}^*,\mu^*)$ the \textbf{completion} of $(X,\mathcal{M},\mu)$.
\end{definition}
In particular, every subset of a set with measure $0$ is measurable.
\subsection{$L^1(\mu)$ as a normed space}
\begin{proposition}
    \begin{enumerate}
        \item Let $f:X\to[0,+\infty)$ be measurable, $E\in\mathcal{M}$.
            If $\int_E f\d{\mu}=0$, then $f=0$ almost everywhere in $E$.
        \item Let $f\in L^1(\mu)$.
            If $\int_E f\d{\mu}=0$ for all $E\in\mathcal{M}$, then $f=0$ almost everywhere in $X$.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \begin{enumerate}
        \item Let $A_n=\{x\in E:f(x)>1/n\}$, so that
            \begin{equation*}
                \frac{1}{n}\mu(A_n)\leq\int_{A_n}\d{\mu}\leq\int_E f\d{\mu}=0\Longrightarrow \mu(A_n)=0
            \end{equation*}
            for all $n$.
            But then
            \[N=\{x\in E:f(x)>0\}=\bigcup\limits_{n=1}^\infty A_n\to \mu(N)\leq\sum\mu(A_n)=0\]
        \item Write $f=u+iv$ so that
            \begin{equation*}
                \int_E f\d{\mu}=\int_E u^+\d{\mu}-\int_E u^-\d{\mu}+i\int_E v^+\d{\mu}-i\int_E v^-\d{\mu}
            \end{equation*}
            We show that $u^+=0$ almost everywhere (the other terms are identical).
            Let $E=\{x\in X:u(x)\geq 0\}$, so $\int_E f\d{\mu}=0$, so its real part is zero and $\int_E u^+\d{\mu}=0$.
            Thus $u^+=0$ almost everywhere in $E$.
            The result follows.
    \end{enumerate}
\end{proof}
\begin{definition}
    A \textbf{normed space} over $\R$ is a vector space $V$ over $\R$ with a map $\norm{\cdot}:V\to\R$ such that
    \begin{enumerate}[label=(\roman*)]
        \item $x\in V\Rightarrow\norm{x}\geq 0$ and $\norm{x}=0$ if and only if $x=0$.
        \item $\norm{\lambda x}\leq|\lambda|\norm{x}$ for all $\lambda\in\R$ and $x\in V$
        \item $\norm{x+y}\leq\norm{x}+\norm{y}$ for all $x,y\in V$.
    \end{enumerate}
\end{definition}
Now $L^1(\mu)=\{f:X\to\C\text{ measurable and }\int_X|f|\d{\mu}<\infty\}$.
We certainly have that $L^1(\mu)$ is a vector space.
We wish to define $\norm{f}=\int_X|f|\d{\mu}$.
The only problem is that
\[\int_X|f|\d{\mu}=0\Longrightarrow f=0\text{ almost everywhere}\]
To deal with this problem, we quotient our space by the equivalence relation $f\sim g$ if and only if $f=g$ almost everywhere.
With this in mind, define $V=L^1(\mu)/\sim$ denote the set of equivalence classes.
We need to define $+,\cdot,\norm{\cdot}$ on $V$.
Let $[f]$ denote the class of $f$.
Then
\begin{align*}
    [f]+[g]&=[f+g]\\
    c[f] &= [cf]\\
    \norm{[f]} &= \int_X|f|\d{\mu}
\end{align*}
Let's verify that this is well defined: if $f_1\sim f_2$ and $g_1\sim g_2$, then $f_1+g_1\sim f_2+g_2$.
Indeed, this is true since the sums are equal except perhaps on a union of measure zero sets, so equality holds almost everywhere.
The second definition is obviously well defined.
Finally, by a homework assignment, $\norm{[f]}$ is also well defined.
Now, let's verify the properties of the norm.
\begin{enumerate}[label=(\roman*)]
    \item Certainly $\norm{[f]}\geq 0$, and $\norm{[f]}=0$ implies $f=0$ almost everywhere, so $[f]=[0]=0$.
    \item We have $\norm{\lambda\cdot[f]}=\int_X|\lambda f|\d{\mu}=|\lambda|\int_X|f|\d{\mu}=|\lambda|\norm{[f]}$
    \item We have $\norm{[f]+[g]}=\int_X|f+g|\d{\mu}\leq\int_X|f|+\int_X|g|=\norm{[f]}+\norm{[g]}$
\end{enumerate}
In $L^1(\mu)$, two functions are the same if they are equal almost everywhere.
However, this can be a challenge: if $f\in L^1(\mu)$ and $x_0\in X$, then $f(x_0)$ is not well defined.
For example, it is challenging to give meaning to boundary conditions of functions.
\subsection{Construction of the Lebesgue measure}
We begin from the Riemann integral $\int_a^b f(x)\d{x}$ for a continuous function $f$.
Define $\supp f=\overline{\{x\in\R:f(x)\neq 0\}}$.
For continuous functions with compact (bounded) support, define $\Lambda f=\int_{\R} f(x)\d{x}$ is the Riemann integral, which is a functional.
In particular,
\[\text{measure}((a,b))=\text{length}((a,b))=\sup\{\Lambda f:f\text{ is continuous, compact support, }0\leq f\leq 1,\supp f\subset(a,b)\}\]
We will extend this to a $\sigma-$algebra containing the Borel sets.
In order to define these, for open sets, $\mu(G)=\sup\{\Lambda f:0\leq f\leq 1,\supp f\subset G\}$, where $\Lambda$ is the Riemann integral.
For an arbitrary set, $\mu(E)=\inf\{\mu(G):E\subset G\in\tau\}$.
However, this ``measure'' is not countably additive: the $\sigma-$algebra $\mathcal{P}(X)$ is too large (Vitali's construction).
Instead, we will define $\mathcal{M}=\{E\subset X:E\text{ is locally regular}\}$, which means that $E\cap K$ is regular for any $K$ compact, and regular means that the outer measure and inner measure are equal.
The outer measure is $\sup\{\mu(K):K\subset E\text{ compact}\}=\mu(E)$.
\section{The Riesz Representation Theorem}
In this section, we assume that $(X,\tau)$ be a locally compact, Hausdorff topological space.
\begin{definition}
    We denote the space of continuous functions with compact support by $C_c(X)=\{f:X\to\C\mid f\in C(X),\supp f\text{ is compact}\}$.
\end{definition}
\begin{definition}
    Let $\Lambda:C_c(X)\to\C$ be a \textbf{linear functional}, i.e. $\Lambda(cf+g)=c\Lambda f+\Lambda g$.
    $\Lambda$ is called a \textbf{positive} linear functional if $f\geq 0\Rightarrow\Lambda f\geq 0$.
\end{definition}
\begin{definition}
    We say that $K\prec f$ if $K$ is compact and $f\in C_c(X)$, $0\leq f\leq 1$ implies that $x\in K\Rightarrow f(x)=1$.
    We say that $f\prec G$ if $G$ is open, $f\in C_c(X)$, $0\leq f\leq 1$, and $\supp f\subset G$.
\end{definition}
\begin{lemma}[Urysohn]
    Let $G\in\tau$, $K\subset G$ compact.
    Then there exists $f\in C_c(X)$ such that $K\prec f\prec G$.
\end{lemma}
\begin{proof}
    Will do later.
\end{proof}
\begin{lemma}[Partition of Unity]
    Let $G_1,G_2,\ldots,G_n\in\tau$, an let $K\subset G_1\cup\cdots\cup G_n$ be compact.
    Then there are functions $h_i\in C_c(X)$ such that $h_i\prec G_i$ and $K\prec \sum h_i$.
\end{lemma}
\begin{proof}
    Also will do later.
\end{proof}
How can we create a positive linear functional on $C_c(X)$?
If $\mu$ is a measure, and functions on $C_c(X)$ are measurable, then $\Lambda f=\int_X f\d{\mu}$ is a positive linear functional.
The representation theorem says that there are no other examples.
\begin{theorem}[Riesz Representation]
    Let $(X,\tau)$ be as above.
    If $\Lambda:C_c(X)\to\C$ is a positive linear functional, then there exists a unique measure space $(X,\mathcal{M},\mu)$ such that $\Lambda f=\int_Xf\d{\mu}$ for any $f\in C_c(X)$, $\mathcal{M}\supset\tau$, and
    \begin{enumerate}[label=(\roman*),nolistsep]
        \item $\mu(E)=\inf\{\mu(G):E\subset G\text{ open}\}$ for all $E\in\mathcal{M}$.
        \item $\mu(E)=\sup\{\mu(K):K\subset E\text{ compact}\}$ for all $E\in\mathcal{M}$ with $\mu(E)<\infty$.
        \item $\mu(K)<\infty$ for any $K$ compact.
        \item $\mathcal{M}$ is complete.
    \end{enumerate}
\end{theorem}
First, let's get some definitions out of the way.
Fix the notation as above.
\begin{definition}
    Fix a Borel measure $\mu$.
    The \textbf{Lebesgue outer measure} is defined $\mu(E)=\inf\{\mu(G):E\subset G\text{ open}\}$.
\end{definition}
\begin{definition}
    We say that $E\subset X$ is \textbf{regular} if $\mu(E)=\sup\{\mu(K):K\subset E\text{ compact}\}$.
    Similarly, $E\subset X$ is \textbf{locally regular} if there exists a compact $K$ so that $K\cap E$ is regular.
\end{definition}
\begin{proof}
    For an open set $G\in\tau$, let $\mu(G)=\sup\{\Lambda f:f\prec G\}$.
    Then $\mu(\emptyset)=0$ and $G_1\subset G_2$ implies that $\mu(G_1)\leq\mu(G_2)$.
    Then extend $\mu$ to arbitrary $E\subset X$ as an outer measure.
    
    Now let $\mathcal{M}=\{E\subset X:E\text{ is locally regular}\}$.
    Let's first see that $\mathcal{M}$ satisfies the desired properties.
    We first see that $\mathcal{M}$ is complete.
    Let $E\in\mathcal{M}$, $\mu(E)=0$ and $A\subset E$.
    We want to show that $A\in\mathcal{M}$.
    Let $K$ be compact, and consider $K\cap A$ so that $\mu(K\cap A)=0$.
    Then if $F\subset K\cap A$ is compact, $\mu(F)=0$ implies $\sup\{\mu(F):F\subset K\cap A\text{ compact}\}=0$.

\end{proof}
\textbf{Claim 1: $\mu$ is $\sigma-$subadditive.}
\begin{proof}
    If $\mu(E_j)=\infty$ for some $j$, then we are done.
    Thus assume $\mu(E_j)<\infty$ for all $j$.
    Let $\epsilon>0$, $\gamma<\mu\left(\bigcup\limits_{j=1}^\infty E_j\right)$ be arbitrary.
    Let $G_j\supset E_j$ be open, such that $\mu(G_j)\leq\mu(E_j)+\frac{\epsilon}{2^j}$.
    Then
    \[j<\mu\left(\bigcup\limits_{j=1}^\infty E_j\right)\leq \mu\left(\bigcup\limits_{j=1}^\infty G_j\right)\]
    so there exists some $f\prec \bigcup\limits_{j=1}^\infty G_j$ so $j<\Lambda f$.
    Let $K=\supp f$ and $K\subset\bigcup\limits_{j=1}^\infty G_j$ and by compactness there exists some $n$ so $K\subset\bigcup\limits_{j=1}^n G_j$.
    Apply our partition of unity and get some $h_j\prec G_j$ for each $j=1,\ldots,n$ such that if $x\in K$, then $\sum\limits_{j=1}^n h_j(x)=1$.
    Then $f\cdot h_j\prec G_j$ so $f=f\cdot\sum\limits_{j=1}^n h_j$.

    Thus
    \begin{align*}
        \gamma &<\Lambda f=\Lambda\left(\sum\limits_{j=1}^n fh_j\right)=\sum\limits_{j=1}^n\Lambda(fh_j)\\
               &\leq \sum\limits_{j=1}^n \mu(G_j)\leq \sum\limits_{j=1}^n\left(\mu(E_j)+\frac{\epsilon}{2^j}\right)\\
               &\leq \sum\limits_{j=1}^\infty\left(\mu(E_j)\right)+\epsilon
    \end{align*}
    which holds for all $\epsilon>0$ if and only if
    \begin{equation*}
        \gamma\leq\sum\limits_{j=1}^\infty\mu(E_j)
    \end{equation*}
    for all $\gamma\leq\mu\left(\bigcup\limits_{j=1}^\infty E_j\right)$ and the result follows.
\end{proof}
\textbf{Claim 2: If $K\prec f\prec G$, then $\mu(K)\leq\Lambda f\leq\mu(G)$.
    Thus if $K$ is compact, $\mu(K)=\inf\{\Lambda f:K\prec f\}$, so $\mu(K)<\infty$.
}
\begin{proof}
    It is obvoius that $\Lambda f\leq\mu(G)$.
    Thus let $\gamma<\mu(K)$ and $\alpha\in(0,1)$.
    Let $V_\alpha:=\{x\in X:f(x)>\alpha\}$ and $K\subset V_\alpha$.
    Now $\gamma<\mu(K)\leq\mu(V_\alpha)$, so we have some $h\prec V_\alpha$ such that $\gamma<\Lambda h$.
    Then $\alpha\cdot h\leq f$ since in $V_\alpha$, $\alpha\cdot h\leq\alpha<f$ and in $V_\alpha^c$, $\alpha\cdot h=0\leq f$.
    Now $\alpha\cdot\Lambda h=\Lambda(\alpha h)\leq\Lambda f$ so $\gamma<\Lambda f/\alpha$.
    This is true for all $\alpha\in(0,1)$ and $\gamma\leq\Lambda f$.
    Since this holds for all $\gamma<\mu(K)$, we have $\mu(K)\leq\Lambda f$ as required.

    Now, let $K$ be compact.
    Since $\mu(K)\leq\Lambda f$ for all $K\prec f$.
    Let $\epsilon>0$, so we have $G\in\tau$, $G\supset K$ such that $\mu(G)\leq\mu(K)+\epsilon$.
    Then by Urysohn's lemma, get some $f$ so that $\mu(K)\leq\Lambda f\leq\mu(G)$, so $\Lambda f\leq\mu(K)+\epsilon$ and the result holds.
\end{proof}
\textbf{Claim 3: If $0\leq f\leq 1$, then $\Lambda f\leq\mu(\supp f)$.}
\begin{proof}
    Let $G\supset\supp f$ be open, so $f\prec G$ and $\mu(G)\geq\Lambda f$.
    Then $\mu(\supp f)=\inf\{\mu(G):E\subset G\in\tau\}\geq\Lambda f$.
\end{proof}
\textbf{Claim 4: If $G\in\tau$, then $G$ is regular.}
\begin{proof}
    We must show $\mu(G)=\sup\{\mu(K):K\subset E\text{ compact}\}$.
    Take $\gamma<\mu(G)$.
    We know that $\sup\{\mu(K):K\subset G\text{ compact}\}\leq\mu(G)$, so we prove the $\geq$ case.
    We need $K$ compact so that $\mu(K)>\gamma$.
    Let $f\prec G$ be such that $\Lambda f>\gamma$.
    Then $\mu(\supp f)>\gamma$ is compact, as desired.
\end{proof}
\textbf{Claim 5: If $E_i$ are disjoint regular, then $\mu\left(\bigcup\limits_{i=1}^\infty E_i\right)=\sum\limits_{i=1}^\infty \mu(E_i)$.}
\begin{proof}
    We first prove this for two compact sets.
    Thus let $K_1,K_2$ be disjoint compact sets.
    Then $K_2^c$ is open and $K_2^c\supset K_1$.
    By Urysohn's lemma, get $f\in C_c(X)$ so that $K_1\prec f\prec K_2^c$ and $x\in K_1$ implies $f(x)=1$, and $x\in K_2$ implies $f(x)=0$.
    Since $K_1\cup K_2$ is compact, for all $\epsilon>0$, get $g\prec K_1\cup K_2$ such that $\mu(K_1\cup K_2)+\epsilon>\Lambda g$.
    Note that $K_1\prec f\cdot g$ and $K_2\prec(1-f)\cdot g$.
    Thus $\mu(K_1)+\mu(K_2)\leq\Lambda(f\cdot g)+\Lambda((1-f)\cdot g=\Lambda g<\mu(K_1\cup K_2)+\epsilon$ which is true for any $\epsilon>0$.
    Thus $\mu(K_1)+\mu(K_2)\leq\mu(K_1\cup K_2)\leq\mu(K_1)+\mu(K_2)$ as required.

    We now prove that $\mu(\cup E_i)\geq\sum\mu(E_i)$.
    If $\mu(\cup E_i)=+\infty$, we are done, so assume $\mu(\cup E_i)<+\infty$.
    If the $E_i$ are regular, then there is a compact set $H_i\subset E_i$ so that
    \[\mu(H_i)>\mu(E_i)-\frac{\epsilon}{2^i}\]
    Let $K_n=\bigcup\limits_{i=1}^n H_i$.
    Now
    \begin{align*}
        \mu\left(\bigcup\limits_{i=1}^\infty E_i\right) &\geq \mu(K_n)\\
                                                        &= \sum\limits_{i=1}^n \mu(H_i)\\
                                                        &> \sum\limits_{i=1}^n\mu(E_i)-\epsilon
    \end{align*}
    As well, this holds for any $\epsilon>0$ and $n\in\N$, so we are done.
\end{proof}
\textbf{Claim 6: If the $E_i$ are regular, then $\bigcup\limits_{i=1}^\infty E_i$ is regular when $\mu(\cup E_i)<\infty$.}
\begin{proof}
    We have
    \begin{align*}
        \mu\left(\bigcup\limits_{i=1}^\infty E_i\right) &\leq \sum\limits_{i=1}^N\mu(E_i)+\epsilon\\
                                                        &\leq \mu(K_N)+2\epsilon
    \end{align*}
    Thus for any $\epsilon>0$, get $N$ so that
    \[\mu\left(\bigcup\limits_{i=1}^\infty E_i\right)-2\epsilon\leq\mu(K_n)\]
    so $\cup E_i$ is regular.
\end{proof}
\textbf{Claim 6(?): $E$ is regular and $\mu(E)<\infty$ if and only if for any $\epsilon>0$, there exists $K$ compact, $G$ open so that $K\subset E\subset G$ and $\mu(G\setminus K)<\epsilon$.}
\begin{proof}
    There exists by regularity (and the definition of the outer measure) $K,G$ so that
    \[\mu(E)-\frac{\epsilon}{2}\leq \mu(K)\leq \mu(G)\leq \mu(E)+\epsilon/2\]
    As well, $\mu(G)=\mu(K\cup(G\setminus K))=\mu(K)+\mu(G\setminus K)$ and $\mu(G\setminus K)=\mu(G)-\mu(K)<\epsilon$.

    Conversely, let $K\subset E\subset G$ and $\mu(G\setminus K)<\epsilon$.
    Then
    \[\mu(E)\leq\mu(G)=\mu(K)+\mu(G\setminus K)<\mu(K)+\epsilon\]
    so $\mu(E)<\infty$ and $\mu(E)=\sup\{\mu(K):K\subset E\text{ compact}\}$, and $E$ is regular.
\end{proof}
\textbf{Claim 7:
    \begin{enumerate}
        \item Let $A,B$ be regular with $\mu(A),\mu(B)<\infty$.
            Then $A\setminus B$, $A\cup B$, $A\cap B$ are regular and have finite measure.
        \item If $E$ is regular and $\mu(E)<\infty$, then $E$ is locally regular.
        \item If $E_i$ are regular, then $\bigcup\limits_{i=1}^\infty E_i$ is regular.
    \end{enumerate}
}
\begin{proof}
    Recall that for any $\epsilon>0$, there exists $K_1\subset A \subset G_1$ and $K_2\subset B\subset G_2$ such that $\mu(G_1\setminus K_1)<\epsilon$ and $\mu(G_2\setminus K_2)<\epsilon$.
    \begin{enumerate}
        \item Note that $A\setminus B\subset G_1\setminus K_2\subset(G_1\setminus K_1)\cup(K_1\setminus G_2)\cup(G_2\setminus K_2)$, where $K_1\setminus G_2$ is compact.
            Thus $\mu(A\setminus B)\leq\epsilon+\mu(K_1\setminus G_1)+\epsilon<\infty$ and $\mu(A\setminus B)-2\epsilon\leq\mu(K_1\setminus G_2)$ so $A\setminus B$ is regular.
            Finally since $A\cup B=(A\setminus B)\cup B$, $A\cup B$ is regular and $\mu(A\cup B)<\infty$.
            Thus $A\cap B=(A\cup B)\setminus( (A\setminus B)\cup(B\setminus A))$ is regular and has measure less than infinity.
        \item Let $E$ be regular, $\mu(E)<\infty$, and $K$ be a compact set.
            Then $\mu(K)<\infty$, $K$ is regular, $E\cap K$ is regular and $E$ is locally regular.
        \item Set $F_1=E_1$, $F_n=E_n\setminus\left(\bigcup\limits_{i=1}^{n-1}E_i\right)$ so $\bigcup\limits_{i=1}^\infty F_i=\bigcup\limits_{i=1}^\infty E_i$ and the $F_i$ as disjoint.
            By Claim 5, $\cup F_i$ is regular and $F_i$ are regular.
    \end{enumerate}
\end{proof}
\textbf{Claim 8: If $E$ is locally regular and $\mu(E)<\infty$, then $E$ is regular.}
\begin{proof}
    Let $\epsilon>0$ and $G\supset E$ be open so that $\mu(G)<\mu(E)+1<\infty$.
    As well, $G$ is regular, so there exists $K$ with $\mu(G)<\mu(K)+\epsilon/2$.
    Now,
    \begin{align*}
        \mu(E)&=\mu((E\setminus K)\cup (E\cap K))\leq \mu(E\setminus K)+\mu(E\cap K)\\
              &\leq\mu(G\setminus K)+\mu(E\cap K)\\
              &<\frac{\epsilon}{2}+\mu(E\cap K)
    \end{align*}
    so $\mu(E\cap K)>\mu(E)-\epsilon/2$.
    Then since $E$ is locally regular, $E\cap K$ is regular and get a compact set $L\subset E\cap K$ such that $\mu(L)>\mu(E\cap K)-\epsilon/2>\mu(E)-\epsilon$.
    Thus $E$ is regular.
\end{proof}
\textbf{Claim 9: $\mathcal{M}$ is a $\sigma-$algebra, $M\subset\tau$, and $\mu$ is countably additive on $\mathcal{M}$.}
\begin{proof}
    Let $A\in\mathcal{M}$: we see that $A^c\in\mathcal{M}$.
    For any $K$ compact, $A\cap K$ is regular.
    Let $K$ be compact and take $A^c\cap K=K\setminus(A\cap K)$ is regular by Claim 7.

    Now let $A_n\in\mathcal{M}$: we see that $A:=\bigcup\limits_{n=1}^\infty A_n\in\mathcal{M}$.
    Let $K$ be an arbitrary compact set, so
    \[A\cap K=\bigcup\limits_{n=1}^\infty (A_n\cap K)\]
    is regular by Claim 7.
    
    We now show $\mathcal{M}\supset\tau$.
    It suffices by closure under complement that al the closed sets are in $\mathcal{M}$.
    If $A$ is closed, then $A\cap K$ is compact and thus regular, so $A\in\mathcal{M}$.

    Finally, let $E_i\in\mathcal{M}$ be disjoint: we see that $\mu\left(\bigcup\limits_{i=1}^\infty E_i\right)=\sum\limits_{i=1}^\infty \mu(E_i)$.
    It suffices to show $\geq$.
    If $\mu(E_i)=+\infty$, we are done, so assume $\mu(E_i)<\infty$ for all $i$.
    But then by Claim 8, $E_i$ are regular, and the result holds by Claim 5.
\end{proof}
\textbf{Claim 10: $\Lambda f=\int_X f\d{\mu}$ for all $f\in C_c(X)$.}
\begin{proof}
    It suffices to prove this for real valued functions.
    If $f=u+iv$, then $\Lambda f=\Lambda u+i\Lambda v=\int_X u\d{\mu}+i\int_X v\d{\mu}=\int_X f\d{\mu}$.
    Furthermore, it suffices to show $\Lambda f\leq\int_X f\d{\mu}$ since $\Lambda(-f)\leq\int_X -f\d{\mu}$ so that $-\Lambda f\leq -\int_X f\d{\mu}$ and $\Lambda f\geq\int_X f\d{\mu}$, implying equality.

    As well, it is enough to prove that $\Lambda \leq\int f$ for $f\geq 0$.
    Let $K=\supp f$ be compact, and $a=\min f$, $b=\max f$.
    Let $\epsilon>0$ be arbitrary.
    For every $K$, there exists $G\supset K$ so that $\mu(G)\leq\mu(K)+\epsilon$.
    Then by Urysohn's lemma, there exists $h\in C_c(X)$ so that $K\prec g\prec G$.
    Thus $|a|\cdot h(x)=|a|$ for all $x\in K$, so $F=f+|a|h\geq 0$ since $f\geq -|a|$.
    Now
    \[\Lambda f\leq\int_X F\d{\mu}=\int_X f+|a|\int_X h\]
    so $\Lambda f\leq\int_X f+|a|\left(\int_X h-\Lambda g\right)$.
    As well, by Claim 2,
    \[\mu(K)\leq\Lambda h\leq\mu(G)\]
    so that
    \[\int_X\chi_K\leq\int_X h\d{\mu}]\leq \int_X\chi_G=\mu(G)\]
    and $|\Lambda h-\int h|<\epsilon$.
    Thus $\Lambda f\leq\int f+|a|\epsilon$ for all $\epsilon>0$, so $\Lambda f\leq\int f$.

    It now remains to show $\Lambda f\leq\int_X f\d{\mu}$ for $f\geq 0$.
    Since $f=Mf/M$ where $M=\max f$, we can assume $0\leq f\leq 1$.
    Fix $K=\supp f$, let $\epsilon>0$ be arbitrary.
    Let $0=c_0<c_1<c_2<\cdots<c_n=1$ with $c_k-c_{k-1}<\epsilon$ for all $k$ and $\mu(f^{-1}(c_k))=0$ for all $k=1,\ldots,n-1$.
    The existence of such a set follows from Assignment 6.
    Let $K_j=K\cap f^{-1}([c_{j-1},c_j])$ for $j=1,2,\ldots,n$ and $L_j=K\cap f^{-1}([c_{j-1},c_j))$ for $j=1,2,\ldots,n-1$. %]
    To $K_j$ and $\epsilon$, there exists $G_j\supset K_j$ such that $\mu(G_j)\leq\mu(K_j)+\frac{\epsilon}{2^j}$.
    By Urysohn's lemma, get $h_j$ so that $K_h\prec h_j\prec G_j$, so $f\leq\sum\limits_{j=1}^nc_j h_j$ since for $x\notin\supp f=K$, $f=0$, and otherwise, there exists $j$ so that $x\in K_j$ implies $h_j=1$ and $f(x)\leq c_j=c_jh_j(x)\leq\sum\limits c_ih_i$.
    Then
    \begin{align*}
        \Lambda f\leq\Lambda(\sum c_j h_j)&=\sum\limits_{i=1}^n c_j\Lambda h_j\\
                                          &\leq\sum\limits_{j=1}^n c_j\mu(G_j)\\
                                          &\leq \sum\limits_{j=1}^n c_j\mu(K_j)+\sum\limits c_j\frac{\epsilon}{2^j}\\
                                          &\leq \sum\limits_{j=1}^n (c_{j-1}+c_j-c_{j-1})\mu(L_j)+\epsilon\\
                                          &\leq \sum\limits_{j=1}^n c_{j-1}\mu(L_j)+\epsilon\cdot\mu(K)+\epsilon\\
        \intertext{where $g$ is a simple function such that $g(x)=c_{j-1}$ if $x\in L_j$ and $g\leq f$. Then}
                                          &= \int_X g\d{\mu}+\epsilon(1+\mu(K))\\
                                          &\leq \int_X f\d{\mu}+\epsilon(1+\mu(K))
    \end{align*}
    for any $\epsilon>0$, and we are done!
\end{proof}
\section{Regularity Properties of Borel Measures}
We have the Riesz representation theorem in a locally compact Hausdorff space.
Our aim is to intruduce the Lebesgue measure in $\R^k$ which respects translation as well.
\begin{definition}
    A measure defined on the family of Borel sets is called a \textbf{Borel measure}.
\end{definition}
\begin{definition}
    Let $\mu:\mathcal{B}\to[0,+\infty]$ be a Borel measure.
    \begin{enumerate}[nolistsep]
        \item $E$ is called \textbf{outer regular} if $\mu(E)=\inf\{\mu(G):E\subset G\in\tau\}$.
        \item $E$ is called \textbf{inner regular} if $\mu(E)=\sup\{\mu(K):K\subset E,K\text{ compact}\}$
        \item $\mu$ is called \textbf{regular} if every $E\in\mathcal{B}$ is inner and outer regular.
    \end{enumerate}
\end{definition}
\begin{definition}
    A set $E\subset X$ is called \textbf{$\sigma-$compact} if $E=\bigcup\limits_{n=1}^\infty E_n$, for $E_n$ compact.
\end{definition}
\begin{definition}
    A $G_\delta$ set is one of the form $\bigcap\limits_{n=1}^\infty A_n$ with $A_n$ open, and a $F_\sigma$ set is one of the form $\bigcup\limits_{n=1}^\infty B_n$ for $B_n$ closed.
\end{definition}
\begin{theorem}
    Let $X$ be a locally compact, $\sigma-$compact Hausdorff space.
    Let $\mathcal{M}\supset\mathcal{B}$ be a $\sigma-$algebra, $\mu:\mathcal{M}\to[0,+\infty]$ be a measure such that
    \begin{enumerate}[nolistsep,label=(\roman*)]
        \item $\mu(E)=\inf\{\mu(G):E\subset G\in\tau\}$
        \item $\mu(E)=\sup\{\mu(K):K\subset E\text{ compact}\}$, $\mu(E)<\infty$
        \item $\mu(K)<\infty$ for $K$ compact.
    \end{enumerate}
    Then
    \begin{enumerate}[nolistsep]
        \item For all $E\in\mathcal{M}$ and $\epsilon>0$, there exists $F$ closed and $G$ open so that $F\subset E\subset G$ and $\mu(G\setminus F)<\infty$.
        \item $\mu$ is regular
        \item For all $E\in\mathcal{M}$, there exists a $F_\sigma$ set $A$ and a $G_\delta$ set $B$ so $A\subset E\subset B$ and $\mu(B\setminus A)=0$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    Since $X$ is $\sigma-$compact, $X=\bigcup\limits_{n=1}^\infty K_n$, $K_n$ compact.
    \begin{enumerate}
        \item By (iii), we have $\mu(K_n\cap E)<\infty$.
            Thus by (i), get $G_n$ open so that $G_n\supset K_n\cap E$ with $\mu(G_n\setminus(K_n\cap E))<\frac{\epsilon}{2^{n+1}}$.
            Let $G=\bigcup\limits_{n=1}^\infty G_n$ be open, so that $G\setminus E\subset\bigcup(G_n\setminus(K_n\cap E))$ and $\mu(G\setminus U)<\frac{\epsilon}{2}$.
            Repeat this for $E^c$: get an open set $H$ such that $\mu(H\setminus E^c)<\frac{\epsilon}{2}$.
            Then $F=H^c\subset E$ satisfies $\mu(E\setminus F)=\mu(F^c\setminus E^c)=\mu(H\setminus E^c)<\frac{\epsilon}{2}$.
            Then $\mu(G\setminus F)\leq\mu(G\setminus E)+\mu(E\setminus F)<\epsilon$.
            Then $\mu(G\setminus F)\leq\mu(G\setminus E)+\mu(E\setminus F)<\epsilon$.
        \item $E$ is outer regular by (i).
            If $\mu<\infty$, then $E$ is inner regular by (ii).
            If $\mu(E)=\infty$, let $F\subset E$ be given by 1.
            Then $\mu(F)=+\infty$, or $\mu(E)$ would be finite.
            Let $H_n=\bigcup\limits_{k=1}^n(F\cap K_k)$ compact, $H_n\subset F$.
            Then $\bigcup\limits_{n=1}^\infty H_n=F$, and $\mu(H_n)\to\mu(F)=\infty$.
            Thus $\mu(E)=\sup\{\mu(K):K\subset E\text{ compact}\}$.
        \item Apply 1 wih $\epsilon=1/j$ for $j\in\N$.
            Then there exists $F_j\subset E\subset G_j$ so $\mu(G_j\setminus F_j)<\frac{1}{j}$.
            Let $A=\bigcup\limits_{j=1}^\infty F_j$ and $B=\bigcap\limits_{j=1}^\infty G_j$.
            Then $A\subset E\subset B$ and $\mu(B\setminus A)\leq\mu(G_j\setminus F_j)<\frac{1}{j}$, so $\mu(B\setminus A)=0$.
    \end{enumerate}
\end{proof}
\begin{theorem}
    Let $X$ be locally compact and Hausdorff, and assume that every open set is $\sigma-$compact.
    Let $\lambda:\mathcal{B}\to[0,\infty]$ be a Borel measure such that $\lambda(K)<\infty$.
    Then $\lambda$ is regular.
\end{theorem}
\begin{proof}
    Let $\Lambda f=\int_X f\d{\lambda}$.
    Then $\Lambda:C_c(X)\to\C$ is a positive linear functional.
    By the Riesz representation theorem, there exists $\mu:\mathcal{M}\to[0,\infty]$ such that $\int_Xf\d{\mu}=\Lambda f=\int_Xf\d{\lambda}$.
    We see that $\lambda=\mu$ on $\mathcal{B}$.
    We first prove this for open sets.
    Let $G\in\tau$; then there exists $K_n$ so $G=\bigcup\limits_{n=1}^\infty K_n$.
    By Urysohn's lemma, there exists $f_i$ such that $K_i\prec f_i\prec G$.
    Let $g_n=\max\{f_1,f_2,\ldots,f_n\}$, so $g_n\in C_c(X)$, and $g_n\to\chi_G$ pointwise.
    But then
    \begin{align*}
        \lambda(G) &= \int_X\chi_G\d{\lambda}\\
                   &= \int_X\lim_{n\to\infty}g_n\d{\lambda}\\
                   &= \lim_{n\to\infty}\int_X g_n\d{\lambda}\\
                   &= \lim_{n\to\infty}\int_X g_n\d{\mu}\\
                   &= \int_X\lim_{n\to\infty}g_n\d{\mu}\\
                   &= \int_X\chi_G\d{\mu}\\
                   &=\mu(G)
    \end{align*}

    Now for any $E\in\mathcal{B}$, apply (i).
    Then $F\subset E\subset G$, $\mu(G\setminus F)<\epsilon$.
    Since $G\setminus F$ is open, $\lambda(G\setminus F)=\mu(G\setminus F)<\epsilon$ so $\lambda(G)\leq\lambda(E)+\epsilon$.
    Thus $|\mu(E)-\lambda(E)|<\epsilon$ for all $\epsilon>0$ so $\lambda(E)=\mu(E)$.
\end{proof}
\end{document}
